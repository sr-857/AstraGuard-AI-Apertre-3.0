# Docker Compose Override for Development
# This file is used by: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

version: "3.8"

services:
  astra-guard:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - BUILDKIT_INLINE_CACHE=1
    ports:
      - "8000:8000"
    environment:
      - REDIS_URL=redis://redis:6379
      - LOG_LEVEL=DEBUG
      - PYTHONUNBUFFERED=1
      - PYTHONDONTWRITEBYTECODE=1
    volumes:
      - ./backend:/app/backend
      - ./anomaly:/app/anomaly
      - ./core:/app/core
      - ./state_machine:/app/state_machine
      - ./memory_engine:/app/memory_engine
      - ./config:/app/config
      - ./logs:/app/logs
    command: >
      sh -c "pip install -e . &&
             python -m uvicorn backend.main:app --host 0.0.0.0 --port 8000 --reload"
